FROM openjdk:11.0.15

ARG SERVER_INTERNAL_PORT
ARG POSTGRES_HOST
ARG POSTGRES_INTERNAL_PORT
ARG POSTGRES_DB
ARG POSTGRES_USER
ARG POSTGRES_PASSWORD
ARG API_WORK_DIR

WORKDIR ${API_WORK_DIR}

RUN apt update
RUN apt upgrade -y
RUN apt install -y sshpass sudo

COPY . .

RUN ./mvnw clean package -DskipTests -q

EXPOSE ${SERVER_INTERNAL_PORT}

CMD ["./mvnw", "spring-boot:run"]